<html>
<head>
  <meta charset="utf-8">
  <title>Customer Churn Prediction</title>
  <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='style.css') }}">
  <link rel="stylesheet" href="{{ url_for('static', filename='form.css') }}">
</head>

<body>
  <div class="login-root">
    <div class="box-root flex-flex flex-direction--column" style="min-height: 100vh;flex-grow: 1;">
      <div class="loginbackground box-background--white padding-top--64">
        <div class="loginbackground-gridContainer">
          <div class="box-root flex-flex" style="grid-area: top / start / 8 / end;">
            <div class="box-root" style="background-image: linear-gradient(white 0%, rgb(247, 250, 252) 33%); flex-grow: 1;">
            </div>
          </div>

          <div class="box-root flex-flex" style="grid-area: 4 / 2 / auto / 5;">
            <div class="box-root box-divider--light-all-2 animationLeftRight tans3s" style="flex-grow: 1;"></div>
          </div>

          <div class="box-root flex-flex" style="grid-area: 6 / start / auto / 2;">
            <div class="box-root box-background--blue800" style="flex-grow: 1;"></div>
          </div>

          <div class="box-root flex-flex" style="grid-area: 7 / start / auto / 4;">
            <div class="box-root box-background--blue animationLeftRight" style="flex-grow: 1;"></div>
          </div>

          <div class="box-root flex-flex" style="grid-area: 8 / 4 / auto / 6;">
            <div class="box-root box-background--gray100 animationLeftRight tans3s" style="flex-grow: 1;"></div>
          </div>

          <div class="box-root flex-flex" style="grid-area: 2 / 15 / auto / end;">
            <div class="box-root box-background--cyan200 animationRightLeft tans4s" style="flex-grow: 1;"></div>
          </div>

          <div class="box-root flex-flex" style="grid-area: 3 / 14 / auto / end;">
            <div class="box-root box-background--blue animationRightLeft" style="flex-grow: 1;"></div>
          </div>

          <div class="box-root flex-flex" style="grid-area: 4 / 17 / auto / 20;">
            <div class="box-root box-background--gray100 animationRightLeft tans4s" style="flex-grow: 1;"></div>
          </div>

          <div class="box-root flex-flex" style="grid-area: 5 / 14 / auto / 17;">
            <div class="box-root box-divider--light-all-2 animationRightLeft tans3s" style="flex-grow: 1;"></div>
          </div>

        </div>
      </div>

      <div class="box-root padding-top--24 flex-flex flex-direction--column" style="flex-grow: 1; z-index: 9;">
        <div class="box-root padding-top--48 padding-bottom--24 flex-flex flex-justifyContent--center">
          <h1><a href="http://blog.stackfindover.com/" rel="dofollow">Customer Churn Prediction</a></h1>
        </div>
        <form id = "churnform" action="/predict" method="POST">
            <div class="wrapper">
                <div class="header">
                    <ul>
                        <li class="active form_1_progessbar">
                            <div>
                                <p>1</p>
                            </div>
                        </li>
                        <li class="form_2_progessbar">
                            <div>
                                <p>2</p>
                            </div>
                        </li>
                        <li class="form_3_progessbar">
                            <div>
                                <p>3</p>
                            </div>
                        </li>
                    </ul>
                </div>
                <div class="form_wrap">
                    <div class="form_1 data_info">
                        <h2>Basic Information</h2>
                        <div class="form_container">
                            <div class="input_wrap">
                                <label for="tenure">Tenure (months)</label>
                                <input type="number" id="tenure" name="tenure" step="1" required>
                                <!-- <span class="error-message" style="display:none;">This field is required.</span> -->
                            </div>
                            <div class="input_wrap">
                                <label for="gender">Gender</label>
                                <select id="gender" name="gender" required>
                                    <option value="Male">Male</option>
                                    <option value="Female">Female</option>
                                </select>
                            </div>
                            <div class="input_wrap">
                                <label for="senior_citizen">Senior Citizen</label>
                                <select id="senior_citizen" name="senior_citizen" required>
                                    <option value="No">No</option>
                                    <option value="Yes">Yes</option>
                                </select>
                            </div>
                            <div class="input_wrap">
                                <label for="partner">Partner</label>
                                <select id="partner" name="partner" required>
                                    <option value="Yes">Yes</option>
                                    <option value="No">No</option>
                                </select>
                            </div>
                            <div class="input_wrap">
                                <label for="dependents">Dependents</label>
                                <select id="dependents" name="dependents" required>
                                    <option value="Yes">Yes</option>
                                    <option value="No">No</option>
                                </select>
                            </div>          
                        </div>
                    </div>
                    <div class="form_2 data_info" style="display: none;">
                        <h2>Service Details</h2>
                        <div class="form_container">
                            <div class="input_wrap">
                                <label for="phone_service">Phone Service</label>
                                <select id="phone_service" name="phone_service" required>
                                    <option value="Yes">Yes</option>
                                    <option value="No">No</option>
                                </select>
                            </div>
                            <div class="input_wrap">
                                <label for="multiple_lines">Multiple Lines</label>
                                <select id="multiple_lines" name="multiple_lines" required>
                                    <option value="Yes">Yes</option>
                                    <option value="No">No</option>
                                    <option value="No phone service">No phone service</option>
                                </select>
                            </div>
                            <div class="input_wrap">
                                <label for="internet_service">Internet Service</label>
                                <select id="internet_service" name="internet_service" required>
                                    <option value="DSL">DSL</option>
                                    <option value="Fiber optic">Fiber optic</option>
                                    <option value="No">No</option>
                                </select>
                            </div>
                            <div class="input_wrap">
                                <label for="online_security">Online Security</label>
                                <select id="online_security" name="online_security" required>
                                    <option value="Yes">Yes</option>
                                    <option value="No">No</option>
                                </select>
                            </div>
                            <div class="input_wrap">
                                <label for="online_backup">Online Backup</label>
                                <select id="online_backup" name="online_backup" required>
                                    <option value="Yes">Yes</option>
                                    <option value="No">No</option>
                                </select>
                            </div>
                            <div class="input_wrap">
                                <label for="device_protection">Device Protection</label>
                                <select id="device_protection" name="device_protection" required>
                                    <option value="Yes">Yes</option>
                                    <option value="No">No</option>
                                </select>
                            </div>
                            <div class="input_wrap">
                                <label for="tech_support">Tech Support</label>
                                <select id="tech_support" name="tech_support" required>
                                    <option value="Yes">Yes</option>
                                    <option value="No">No</option>
                                </select>
                            </div>
                            <div class="input_wrap">
                                <label for="streaming_tv">Streaming TV</label>
                                <select id="streaming_tv" name="streaming_tv" required>
                                    <option value="Yes">Yes</option>
                                    <option value="No">No</option>
                                </select>
                            </div>
                            <div class="input_wrap">
                                <label for="streaming_movies">Streaming Movies</label>
                                <select id="streaming_movies" name="streaming_movies" required>
                                    <option value="Yes">Yes</option>
                                    <option value="No">No</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    <div class="form_3 data_info" style="display: none;">
                        <h2>Personal Information & Payment</h2>
                        <div class="form_container">
                            <div class="input_wrap">
                                <label for="contract">Contract</label>
                                <select id="contract" name="contract" required>
                                    <option value="Month-to-month">Month-to-month</option>
                                    <option value="One year">One year</option>
                                    <option value="Two year">Two year</option>
                                </select>
                            </div>
                            <div class="input_wrap">
                                <label for="paperless_billing">Paperless Billing</label>
                                <select id="paperless_billing" name="paperless_billing" required>
                                    <option value="Yes">Yes</option>
                                    <option value="No">No</option>
                                </select>
                            </div>
                            <div class="input_wrap">
                                <label for="payment_method">Payment Method</label>
                                <select id="payment_method" name="payment_method" required>
                                    <option value="Electronic check">Electronic check</option>
                                    <option value="Mailed check">Mailed check</option>
                                    <option value="Bank transfer (automatic)">Bank transfer (automatic)</option>
                                    <option value="Credit card (automatic)">Credit card (automatic)</option>
                                </select>
                            </div>
                            <div class="input_wrap">
                                <label for="monthly_charges">Monthly Charges</label>
                                <input type="number" id="monthly_charges" name="monthly_charges" step="0.01" required>
                            </div>
                            <div class="input_wrap">
                                <label for="total_charges">Total Charges</label>
                                <input type="number" id="total_charges" name="total_charges" step="0.01" required>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="btns_wrap">
                    <div class="common_btns form_1_btns">
                        <button type="button" class="btn_next">Next <span class="icon"><ion-icon name="arrow-forward-sharp"></ion-icon></span></button>
                    </div>
                    <div class="common_btns form_2_btns" style="display: none;">
                        <button type="button" class="btn_back"><span class="icon"><ion-icon name="arrow-back-sharp"></ion-icon></span>Back</button>
                        <button type="button" class="btn_next">Next <span class="icon"><ion-icon name="arrow-forward-sharp"></ion-icon></span></button>
                    </div>
                    <div class="common_btns form_3_btns" style="display: none;">
                        <button type="button" class="btn_back"><span class="icon"><ion-icon name="arrow-back-sharp"></ion-icon></span>Back</button>
                        <button type="submit" class="btn_done" value="Predict">Done</button>
                        
                    </div>
                </div>
            </div>
        </form>

        <div class="modal_wrapper" id = "resultModal" style="display: none;">
            <div class="shadow"></div>
            <div class="success_wrap">

                <div class="result">
                    <h2 id="resultText">Prediction Result: {{ prediction_text }}</h2>
                </div>
            </div>
        </div>

        <!-- JavaScript Link -->
        <script src="{{ url_for('static', filename='index.js') }}"></script>
        <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
        <script>
            $(document).ready(function() {
                $('#churnform').on('submit', function(e) {
                    e.preventDefault(); // Prevent the default form submission
                    
                    $.ajax({
                        type: 'POST',
                        url: '/predict',
                        data: $(this).serialize(), // Serialize form data
                        success: function(response) {
                            // Hide the form and show the modal
                            $('#churnform').hide();
                            $('#resultModal').show();
                            
                            // Update the modal with the result
                            if (response.result) {
                                $('#resultText').text('Prediction Result: ' + response.result);
                            } else if (response.error) {
                                $('#resultText').text('Error: ' + response.error);
                            }
                        },
                        error: function() {
                            $('#resultText').text('An error occurred while processing the request.');
                        }
                    });
                });
                
                // Optional: Add an event listener to close the modal
                $('.shadow').on('click', function() {
                    $('#resultModal').hide();
                    $('#churnform').show();
                });
            });
        </script>        
</body>

</html>
